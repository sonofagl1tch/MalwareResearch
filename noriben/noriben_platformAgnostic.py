#Noriben Sandbox Automation Script
#conversion from bash to python for crossplatform usability
#Responsible for:
#* Copying malware into a known VM
#* Running malware sample
#* Copying off results
#
#Ensure you set the environment variables below to match your system
##############################################################
#imports
import os

##############################################################
# host based configuration variables
# current username
USERNAME=$(whoami)
# reads in commandline arguement for sample
MALWAREFILE=$1
# used for noriben output files
FILENAME=$(basename $MALWAREFILE)
# full path to vmrun binary. this is required to be referenced in the full path everytime
VMRUN="/Applications/VMware Fusion.app/Contents/Library/vmrun"
# full path to noriben victim vm vmx file
VMX="/Users/$USERNAME/Documents/Virtual Machines.localized/noriben.vmwarevm/noriben.vmx"
# this is the name of the snapshot to revert the vm to
VM_SNAPSHOT="Baseline"
# guest VM username and password
VM_USER=master
VM_PASS=master
# local host file path for procmon
PROCMON="/Users/$USERNAME/Downloads/Procmon.exe"
# local host file path for procmon configuration file
PROCMONCONFIG="/Users/$USERNAME/Downloads/ProcmonConfiguration.pmc"
##############################################################
# guest based configuration variables
# variable for execution delay
DELAY=10
# noriben path on guest
NORIBEN_PATH="C:\\Users\\master\\Downloads\\Noriben.py"
# zipped noriben results path on guest
ZIP_PATH="C:\\Tools\\zip.exe"
# noriben results path on guest
LOG_PATH="C:\\Noriben_Logs"
# python path on guest
PYTHON_PATH="C:\\Users\\master\\AppData\\Local\\Programs\\Python\\Python36\\python.exe"
# procmon path on guest
PROCMONPATH="C:\\Users\\master\\Downloads\\chrome.exe"
# procmon configuration file path on guest
PROCMONCONFIGPATH="C:\\Users\\master\\Downloads\\ProcmonConfiguration.pmc"
# sample path on guest
MALWARE_PATH="C:\\Users\\master\\Downloads\\Malware.exe"
##############################################################
